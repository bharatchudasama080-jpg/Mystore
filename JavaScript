document.addEventListener('DOMContentLoaded', () => {
    // Get the product and cart elements from the HTML
    const productGrid = document.getElementById('products');
    const cartItemsList = document.getElementById('cart-items');
    const cartTotalElement = document.getElementById('cart-total');
    const checkoutButton = document.getElementById('checkout-btn');

    // Load cart data from the browser's local storage, or start with an empty cart
    let cart = JSON.parse(localStorage.getItem('shoppingCart')) || {};

    // Save cart data to local storage
    const saveCart = () => {
        localStorage.setItem('shoppingCart', JSON.stringify(cart));
    };

    // Render the cart items on the page
    const renderCart = () => {
        cartItemsList.innerHTML = '';
        let total = 0;

        for (const productId in cart) {
            const item = cart[productId];
            const li = document.createElement('li');
            li.innerHTML = `
                ${item.name} - ₹${item.price} x ${item.quantity}
                <button class="remove-from-cart" data-id="${productId}">Remove</button>
            `;
            cartItemsList.appendChild(li);
            total += item.price * item.quantity;
        }

        cartTotalElement.textContent = `Total: ₹${total}`;

        // Show or hide the checkout button based on whether the cart has items
        if (total > 0) {
            checkoutButton.style.display = 'block';
        } else {
            checkoutButton.style.display = 'none';
        }
    };

    // Handle clicks on "Add to Cart" buttons
    productGrid.addEventListener('click', (event) => {
        if (event.target.classList.contains('add-to-cart')) {
            const button = event.target;
            const productElement = button.closest('.product');
            
            const id = productElement.dataset.id;
            const name = productElement.dataset.name;
            const price = parseFloat(productElement.dataset.price);

            if (cart[id]) {
                cart[id].quantity += 1;
            } else {
                cart[id] = { id, name, price, quantity: 1 };
            }
            
            saveCart();
            renderCart();
            alert(`${name} added to cart!`);
        }
    });

    // Handle clicks on "Remove" buttons inside the cart
    cartItemsList.addEventListener('click', (event) => {
        if (event.target.classList.contains('remove-from-cart')) {
            const button = event.target;
            const productId = button.dataset.id;
            
            if (cart[productId]) {
                delete cart[productId];
                saveCart();
                renderCart();
            }
        }
    });

    // Handle click on the "Checkout" button
    checkoutButton.addEventListener('click', () => {
        // Redirect the user to the checkout page
        window.location.href = 'checkout.html';
    });

    // Initial render of the cart when the page loads
    renderCart();
});
